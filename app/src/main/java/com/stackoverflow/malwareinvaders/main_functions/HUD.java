package com.stackoverflow.malwareinvaders.main_functions;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.RectF;
import android.graphics.Typeface;

import java.util.ArrayList;

/**
 * This class contains all the HUD we have in game such as numbers of lives, scores and ammo
 */
class HUD {
    private int mScreenX;
    private int mScreenY;
    private Context mContext;
    Typeface mTypeface;
    private int mFontSize;
    private int mFontMarginX;
    private int mFontMarginY;
    private float heartWidth;
    private float heartHeight;
    private float left;
    private float top;
    private RectF signalClipRect;
    private float signalInnerMargin;


    HUD(Typeface typeface, int FontSize, int FontMarginX, int FontMarginY, Context context,int ScreenX,int ScreenY) {
        mTypeface = typeface;
        mFontSize = FontSize;
        mFontMarginX = FontMarginX;
        mFontMarginY = FontMarginY;
        mContext = context;
        mScreenX = ScreenX;
        mScreenY = ScreenY;

        heartWidth = (mScreenX/20);
        heartHeight = (mScreenY/30);
        left = mScreenX - (mFontMarginX + (heartWidth * 3));
        top = mFontMarginY/2;
        signalInnerMargin = mScreenX/50;


        //signalClipRect = new RectF((mScreenX/2) - (mScreenX/10), (mScreenY/2) - (mScreenY/50), (mScreenX/2) + (mScreenX/10), (mScreenY/2) + (mScreenY/50));
        signalClipRect = new RectF();
        // dimension of Phoenix bottom margin
        signalClipRect.bottom = mScreenY - (mScreenY/50);
        // dimension of Signal height
        signalClipRect.top = signalClipRect.bottom - ((mScreenX/20) + (signalInnerMargin*2));
        signalClipRect.right = mScreenX - FontMarginX;
        // dimension of Signal width
        signalClipRect.left = signalClipRect.right - signalInnerMargin - (((mScreenX/40)+signalInnerMargin)*3);
    }

    void draw(Canvas mCanvas, Paint mPaint, int mLives, int mScore, ArrayList<Signal> mClip){

        mPaint.setTypeface(mTypeface);
        mPaint.setColor(Color.WHITE); // Could be changed later
        // Choose the font size
        mPaint.setTextSize(mFontSize);
        mCanvas.drawText("Scores: ", mFontMarginX, mFontMarginY, mPaint);
        float score_width = mPaint.measureText("Scores: ");
        mPaint.setColor(Color.YELLOW); // Could be changed later
        mCanvas.drawText(""+ mScore, mFontMarginX + score_width, mFontMarginY, mPaint);

        float lives_width = mPaint.measureText("Lives: ");
        mPaint.setColor(Color.WHITE); // Could be changed later
        mCanvas.drawText("Lives: ",left - lives_width,mFontMarginY,mPaint);

        Bitmap img = BitmapFactory.decodeResource(mContext.getResources(), R.drawable.heart2);
        //Bitmap resizedImg = Bitmap.createScaledBitmap(img, (int)heartWidth, (int)heartHeight, true);

        for (int cnt = 0, i = 0, j = 0; cnt<mLives; cnt++, i++){
            // Only at max 3 lives are shown per line
            if(cnt%3 == 0){
                i=0;
                j++;
            }
            mCanvas.drawBitmap(img, left + (heartWidth * i), top * j, mPaint);
        }

        // Draw the Signal Clip
        // We'll draw the box first
        mPaint.setStyle(Paint.Style.STROKE);
        mCanvas.drawRect(signalClipRect,mPaint);

        // Now we'll check how many Signals are alive and draw them
        for (int i=mClip.size()-1, j=0; i>=0; i--) {
            if(!mClip.get(i).isAlive()){
                mCanvas.drawBitmap(mClip.get(i).getImg(), signalClipRect.left + signalInnerMargin + (((mScreenX/40)+signalInnerMargin)*j),signalClipRect.top + signalInnerMargin, mPaint);
                j++;
            }
        }
        // Reset the paint style
        mPaint.setStyle(Paint.Style.FILL);

    }


}
